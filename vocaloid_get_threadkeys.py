import requests, random, string, json, time, sys

# コマンドライン引数から開始インデックスを取得
if len(sys.argv) > 1:
    start_idx = int(sys.argv[1])
else:
    print("Please provide a starting index as a command-line argument.")
    sys.exit(1)

headers = {
    "X-Frontend-Id": "6",
    "X-Frontend-Version": "0"
}

movieIds = ['sm14027065', 'sm41743858', 'sm1639267', 'sm1097445', 'sm15630734',
            'sm1715919', 'sm17669123', 'sm10759623', 'sm2129043', 'sm11398357',
            'sm41943266', 'sm21722914', 'sm15751190', 'sm11931525', 'sm2937784',
            'sm11809611', 'sm8089993', 'sm33510542', 'sm18406343', 'sm17520775',
            'sm4468648', 'sm3504435', 'sm20470051', 'sm41951611', 'sm2406770',
            'sm3133304', 'sm9020236', 'sm31791630', 'sm5937205', 'sm3645817',
            'sm4841649', 'sm31606995', 'sm28276238', 'sm2352095', 'sm4566633',
            'sm20116702', 'sm982882', 'sm13581709', 'sm19133907', 'sm14583646',
            'sm4323597', 'sm18100389', 'sm14330479', 'sm32798041', 'sm15423776',
            'sm13386216', 'nm6049209', 'sm7994613', 'sm19761417', 'sm1274898',
            'sm9714351', 'sm27965309', 'sm21737751', 'sm24276234', 'sm14730509',
            'sm19285775', 'sm1465138', 'sm2397344', 'sm15108950', 'sm13612500',
            'sm4136912', 'sm20244918', 'sm6666016', 'sm8269164', 'sm8082467',
            'sm15308214', 'sm7550182', 'sm10015871', 'sm15172108', 'sm8686165',
            'sm16450214', 'sm7528841', 'sm19069321', 'sm17930619', 'sm12825985',
            'sm10393864', 'sm5524166', 'sm21720819', 'sm22960446', 'sm2085047',
            'sm22138447', 'sm4790382', 'sm11519178', 'sm16474954', 'sm32492001',
            'sm2321776', 'sm6119955', 'sm20671920', 'sm18623327', 'sm1991872',
            'sm1340413', 'sm10187442', 'sm5508506', 'sm7559438', 'sm16753732',
            'sm1359820', 'sm17397763', 'sm21259575', 'sm1783839', 'sm41486861',
            'sm2500648', 'sm15484827', 'sm9305683', 'sm7138245', 'sm1588476',
            'sm2413713', 'sm6231060', 'sm19532707', 'sm1563848', 'sm12100064',
            'sm5508956', 'sm6771004', 'sm18198019', 'sm5731492', 'sm12850213',
            'sm31314079', 'sm6006907', 'sm20973193', 'sm4775243', 'sm21443197',
            'sm25771502', 'sm2398630', 'sm29442394', 'sm14991849', 'sm23218876',
            'sm1924663', 'sm17720979', 'sm16915126', 'sm24643818', 'sm18726752',
            'sm11956364', 'sm21513190', 'sm16429826', 'sm3577838', 'sm3401967',
            'so29106104', 'sm15022913', 'sm27905394', 'sm5858956', 'sm6529016',
            'sm12154467', 'sm11328911', 'sm16846374', 'sm16486262', 'sm2149255',
            'sm16110005', 'sm23304692', 'sm16539814', 'sm6928368', 'sm2916956',
            'sm1685138', 'sm19418883', 'sm9032932', 'sm2972481', 'sm26238908',
            'sm16628066', 'sm5865063', 'nm6444532', 'sm5992615', 'sm21702752',
            'sm1136355', 'sm1613775', 'sm12394091', 'sm4410647', 'sm12372183',
            'sm14990051', 'sm13911449', 'sm12174319', 'sm4142314', 'sm30156654',
            'sm24892241', 'sm6287887', 'sm29021785', 'sm3122624', 'sm15165072',
            'sm18511216', 'sm10444862', 'sm1050729', 'sm15977003', 'sm1077399',
            'sm20765934', 'sm29822304', 'sm11982230', 'sm16702635', 'sm7860775',
            'sm3812000', 'sm29315733', 'sm26885145', 'sm12021431', 'sm7902754',
            'sm13808486', 'sm11528934', 'sm9430175', 'sm11694557', 'sm1908098',
            'sm1899931', 'sm22349544', 'sm22885875', 'sm12441199', 'sm2625011',
            'sm4825084', 'sm6609407', 'sm18370004', 'sm15187718', 'sm12253948',
            'sm11861918', 'sm2283599', 'sm4153727', 'sm11379844', 'sm28576299',
            'sm12404031', 'sm18757513', 'sm2097776', 'sm1746621', 'sm31700140',
            'sm2053548', 'sm14989713', 'sm12692734', 'sm41188307', 'sm1803626',
            'sm20423253', 'sm15230821', 'sm11611831', 'sm2871474', 'sm3822999',
            'sm17211747', 'sm14595248', 'sm6816232', 'sm11941354', 'sm6328922',
            'sm1853135', 'sm1848517', 'sm39735145', 'sm15254682', 'sm13304052',
            'sm4424188', 'sm12549753', 'sm12960666', 'sm9047689', 'sm2166743',
            'sm6909505', 'sm3210344', 'sm11777266', 'sm8613443', 'sm11559163',
            'sm4778814', 'sm11713594', 'so18274463', 'sm2509135', 'sm11448922',
            'sm18938918', 'sm17239967', 'sm41190569', 'sm5993253', 'sm3402781',
            'sm29081909', 'sm22441261', 'sm13741173', 'sm19218102',
            'sm42577601', 'sm12327226', 'sm2776500', 'sm16719809', 'sm30469574',
            'sm2370613', 'sm20797677', 'sm3065531', 'sm23648996', 'sm33480697',
            'sm6107122', 'sm14544105', 'sm18783356', 'sm42563162', 'sm14768017',
            'sm2999457', 'sm11565747', 'sm2437325', 'sm13150906', 'sm35512935',
            'sm13400300', 'sm31192903', 'sm19088363', 'sm41945341',
            'sm11293787', 'sm12475944', 'sm17103353', 'sm20286605',
            'sm15657179', 'sm16964617', 'sm10282629', 'sm16762328',
            'sm10770815', 'sm10851396', 'sm13620827', 'sm12050471', 'sm3577734',
            'sm3945173', 'sm19480453', 'sm11620696', 'sm29554456', 'sm19625630',
            'sm35584107', 'sm6165498', 'sm18972745', 'sm11444922', 'sm2428954',
            'sm3132727', 'sm6028599', 'sm33624822', 'sm3151139', 'sm3486994',
            'sm13464038', 'sm13275244', 'sm11070628', 'sm15633620',
            'sm13530373', 'sm31685272', 'sm14731092', 'sm3680987', 'sm10913799',
            'sm20332495', 'sm13628080', 'sm2232288', 'sm2602217', 'sm18626305',
            'sm23750267', 'sm3530943', 'sm1634908', 'sm4112386', 'sm2853652',
            'sm3456595', 'sm12829637', 'sm2690008', 'sm3372021', 'sm14752734',
            'sm17302163', 'sm2931663', 'sm12620490', 'sm19006338', 'sm8430328',
            'sm2040220', 'sm6730066', 'sm11842720', 'sm2301102', 'sm7415020',
            'sm1236668', 'sm12609807', 'sm20132624', 'sm15119688', 'sm10989936',
            'sm4405941', 'sm1859594', 'sm15459189', 'sm8619805', 'sm20304965',
            'sm17802813', 'sm13081858', 'sm10385613', 'sm2115703', 'sm13339148',
            'sm3751018', 'sm11220858', 'sm3298460', 'sm13361994', 'sm6432758',
            'sm1889485', 'so26572007', 'so31837518', 'sm7610111', 'sm13148947',
            'sm1934252', 'sm12762700', 'sm15390685', 'sm8933166', 'sm15723915',
            'sm17167121', 'sm37287661', 'sm5975168', 'sm13610634', 'sm2677103',
            'sm26641878', 'sm4851760', 'sm24990461', 'sm1690379', 'sm10924943',
            'sm30067009', 'sm1860373', 'sm14682302', 'sm4248763', 'sm13285804',
            'sm16999365', 'sm21647485', 'sm13211430', 'sm16044017', 'sm2849292',
            'sm4336653', 'sm17339601', 'sm15047702', 'sm3612645', 'sm5745575',
            'sm30177801', 'sm1728993', 'sm17442402', 'sm3742710', 'sm1880080',
            'sm4638910', 'sm11145958', 'sm21764582', 'sm10209890', 'sm11834233',
            'sm18382294', 'sm4492573', 'sm2981693', 'sm1978581', 'sm8489562',
            'sm4038334', 'sm15313535', 'sm10722893', 'sm6013822', 'sm21283394',
            'sm25223315', 'sm2853380', 'sm15440067', 'sm1949280', 'sm3535393',
            'nm7319309', 'sm20766496', 'sm11448603', 'sm14158317', 'sm21249768',
            'sm17033652', 'sm2137706', 'sm11468381', 'sm7452616', 'sm18430943',
            'sm11179708', 'sm23282287', 'sm12897194', 'sm3821671', 'sm32727744',
            'sm11281764', 'sm17098918', 'sm2435563', 'sm15915407', 'sm5187481',
            'sm4670784', 'sm18488858', 'sm13013900', 'sm10836811', 'sm7780897',
            'sm22474644', 'sm19158453', 'sm15658454', 'nm5988510', 'sm14544332',
            'sm3892053', 'sm11302054', 'sm13021689', 'sm17661915', 'sm24438970',
            'sm4129984', 'sm34470195', 'sm17865432', 'sm18549597', 'sm1952223',
            'sm8630148', 'sm1667273', 'sm6115924', 'sm11974727', 'sm18487123',
            'sm18172311', 'sm5094908', 'sm16901219', 'sm23348919', 'sm7015933',
            'sm4413536', 'sm19811204', 'sm15852554', 'sm3051638', 'sm15981491',
            'sm14539838', 'sm17515598', 'sm4917986', 'sm11842653', 'sm13774194',
            'sm8978338', 'sm15590117', 'sm13715524', 'sm16590269', 'sm23762151',
            'sm2736134', 'sm19870840', 'sm18027040', 'sm10118015', 'sm32499603',
            'sm16776472', 'sm1519894', 'sm15206345', 'sm5834487', 'sm11509720',
            'sm7842954', 'sm4783296', 'sm17235621', 'sm12109923', 'sm4195636',
            'sm3604366', 'sm6020985', 'sm11480547', 'sm7155972', 'sm4260628',
            'sm4998978', 'sm15527124', 'sm10444961', 'sm34871494', 'sm19509983',
            'sm9729349', 'sm16234029', 'sm4640167', 'sm8092816', 'sm8763123',
            'sm14992964', 'sm16531235', 'sm12731298', 'sm20331479',
            'sm17380046', 'sm13857197', 'sm16594262', 'sm36668789',
            'sm14866422', 'sm9815744', 'sm20810930', 'sm1989010', 'sm1572804',
            'sm16305465', 'sm5857175', 'sm16354830', 'sm10597531', 'sm14804665',
            'sm14740387', 'sm3577849', 'sm29544351', 'sm19898621', 'sm4084929',
            'sm15787886', 'sm16573689', 'sm8966268', 'sm9295654', 'sm16655831',
            'sm16742993', 'sm6386642', 'sm4710580', 'sm9229034', 'sm10756760',
            'sm16297479', 'sm9731460', 'sm7756597', 'sm14439679', 'sm7215575',
            'sm10041910', 'sm1405523', 'sm10122021', 'sm23134050', 'sm18228798',
            'sm16895801', 'sm3966413', 'sm12503140', 'sm13136668', 'sm23365106',
            'sm14929592', 'sm3758450', 'sm14193990', 'sm7696158', 'sm4638539',
            'sm9707593', 'sm1908380', 'sm5078336', 'sm5444349', 'sm16837059',
            'sm5070884', 'sm9157992', 'nm14068363', 'sm5561318', 'sm22594888',
            'sm16411019', 'sm6040129', 'sm1249071', 'sm20256053', 'sm8894227',
            'sm9032625', 'sm6456282', 'sm4722003', 'sm10684103', 'sm16469400',
            'sm9498669', 'sm20227603', 'sm11264170', 'sm14820727', 'sm5134729',
            'sm10294519', 'sm5117285', 'sm9647980', 'sm4566244', 'sm7084997',
            'sm11421907', 'sm40359334', 'sm7963737', 'nm7103480', 'sm17910036',
            'sm10375351', 'sm6527493', 'sm8830048', 'sm9340347', 'sm16173623',
            'sm2014550', 'sm9766159', 'sm10150980', 'sm5652741', 'sm18632219',
            'sm17367688', 'sm8626818', 'sm13004628', 'sm2224359', 'sm8966189',
            'sm9096215', 'sm19361252', 'sm1249857', 'sm17766033', 'sm11832728',
            'sm25844477', 'sm3207909', 'sm5958692', 'sm18908759', 'sm9364974',
            'sm7704306', 'sm16017826', 'sm19683818', 'sm18991041', 'sm20081073',
            'sm9261573', 'sm18456093', 'sm27505667', 'sm16713690', 'sm7992704',
            'sm24555945', 'sm5211517', 'sm5279024', 'sm9961348', 'sm20377698',
            'sm15780358', 'sm19856000', 'sm965862', 'sm21758815', 'sm5137429',
            'sm16824501', 'sm4670842', 'sm29782999', 'sm4907650', 'sm4218005',
            'sm16865937', 'so23381595', 'sm8228650', 'sm18965721', 'sm11361320',
            'sm19980280', 'sm19233263', 'sm8694870', 'sm5483070', 'sm18395392',
            'sm9112789', 'sm1803610', 'sm9573759', 'sm15877398', 'sm16059512',
            'sm3135213', 'sm10519967', 'sm15391262', 'sm2500972', 'sm16534618',
            'sm12098837', 'sm17950980', 'sm7830930', 'sm1427306', 'sm31485619',
            'sm3579375', 'sm30541190', 'sm19743126', 'sm18795022', 'sm5628273',
            'sm5430322', 'sm23144598', 'sm9430036', 'sm5348635', 'sm1971028',
            'sm19905283', 'sm5824813', 'sm11884641', 'sm7526154', 'sm26745370',
            'sm5698809', 'sm7781905', 'sm5958217', 'sm16110798', 'sm12695779',
            'sm1468559', 'sm20050783', 'sm9882252', 'sm6597937', 'sm6877129',
            'sm12609934', 'sm2509360', 'sm2398354', 'sm11423292', 'sm15357483',
            'sm26937870', 'sm2516503', 'sm24536934', 'sm30978393', 'sm1894085',
            'sm10933505', 'sm7489260', 'sm13678185', 'sm12419075', 'sm1777406',
            'sm20040564', 'sm4089755', 'sm18733749', 'sm6319063', 'sm16205143',
            'sm13313111', 'sm9390825', 'sm14285610', 'sm16477943', 'sm3440324',
            'sm7899107', 'sm14597032', 'sm30789907', 'sm35992766', 'sm8101264',
            'sm26479837', 'sm2045225', 'sm21050623', 'sm5891226', 'sm16518376',
            'sm3995696', 'sm19466301', 'sm21697223', 'sm17142789', 'sm6808476',
            'sm41193429', 'sm17579383', 'sm18608167', 'sm23910729',
            'sm22857280', 'sm3143714', 'sm9797269', 'sm30057669', 'sm3141518',
            'sm3832253', 'sm16238717', 'sm4559156', 'sm18371210', 'sm3604990',
            'sm3124800', 'sm12894209', 'sm18081644', 'sm13621243', 'sm13885856',
            'sm18671603', 'sm7612136', 'sm6183148', 'sm21986604', 'sm8179127',
            'sm6247760', 'sm11144386', 'sm7966092', 'sm1121675', 'sm17632953',
            'sm12898794', 'sm29910955', 'sm6085510', 'sm31111156', 'sm9205429',
            'sm17804161', 'sm10482108', 'sm17826551', 'sm19697286',
            'sm18658349', 'sm1657814', 'sm6163422', 'sm2393562', 'sm32513315',
            'sm7550803', 'sm39334235', 'sm18008293', 'sm10678247', 'sm6939827',
            'sm21870906', 'sm6793193', 'sm1609005', 'sm20552601', 'sm1085336',
            'sm26863500', 'sm7560113', 'sm1449437', 'sm8032696', 'sm16516897',
            'sm14466435', 'sm6298794', 'sm22210937', 'sm7356788', 'sm7222796',
            'sm2950641', 'sm18220406', 'sm5430176', 'sm5490544', 'sm1697854',
            'sm7290042', 'sm18060733', 'sm6738433', 'sm7763470', 'sm18495350',
            'sm12071293', 'sm1343336', 'sm9422444', 'sm24205476', 'sm19570813',
            'sm33897535', 'sm2244897', 'sm8294432', 'sm22026707', 'sm19904452',
            'sm18253040', 'sm22307037', 'sm16931072', 'sm17890143', 'sm5762545',
            'sm2166779', 'sm13664704', 'sm8562269', 'sm11684418', 'sm10544006',
            'sm30960061', 'sm17121677', 'sm22831329', 'sm18310134',
            'sm22598031', 'sm8934556', 'sm2172473', 'sm2135243', 'sm14375135',
            'sm14639165', 'sm11209477', 'sm8493774', 'sm1140952', 'sm1893548',
            'sm8061508', 'sm20350758', 'sm16866804', 'sm32673722', 'sm9809880',
            'sm12159572', 'sm18851476', 'sm2311383', 'sm30105817', 'sm7414563',
            'sm10005516', 'sm2562067', 'sm2302776', 'sm10114759', 'sm26885931',
            'sm17533722', 'sm7219091', 'sm14100039', 'sm12540305', 'sm17763107',
            'sm2051491', 'sm40354298', 'sm6675330', 'sm7843103', 'sm14926860',
            'sm8923574', 'sm8165194', 'sm19592230', 'sm5081266', 'sm17695401',
            'sm4144858', 'sm18195515', 'sm8033594', 'sm21986543', 'sm8432898',
            'sm11489816', 'sm8368749', 'sm28242091', 'sm7689468', 'sm31533883',
            'sm14592526', 'sm2796188', 'sm18133352', 'sm9088704', 'sm20786253',
            'sm28749432', 'sm10411033', 'sm4048581', 'sm1659550', 'sm7791386',
            'sm4692151', 'sm8532252', 'sm9874560', 'sm18131841', 'sm1929913',
            'nm13359285', 'sm4306301', 'sm5666270', 'sm6029342', 'sm4794708',
            'sm11282678', 'sm15251300', 'sm30822018', 'sm26884070',
            'sm10243594', 'sm9639869', 'sm29145868', 'sm6256856', 'sm2420025',
            'sm8134939', 'sm12338494', 'sm22940714', 'sm37081741', 'sm16931287',
            'sm8899411', 'sm10948305', 'sm13252011', 'sm25627088', 'sm10118723',
            'sm21420113', 'sm20252366', 'sm13944678', 'sm26776624', 'sm1290325',
            'sm15956806', 'sm8231700', 'sm6186467', 'sm16973327', 'sm3053355',
            'sm17064620', 'sm13940452', 'sm1519037', 'sm16036598', 'sm5990158',
            'sm38833751', 'sm6890284', 'sm18330534', 'sm17611572', 'sm9792113',
            'sm15016420', 'sm2029948', 'sm2614381', 'sm3953018', 'sm17347340',
            'sm19053765', 'sm15859668', 'sm2356150', 'sm31840221', 'sm20296308',
            'sm13587322', 'sm11101862', 'nm15614163', 'sm16321602',
            'sm13452778', 'sm15155336', 'sm4408384', 'sm10037227', 'nm6971638',
            'sm8258566', 'sm2398205', 'sm1346602', 'sm19807355', 'sm10570449',
            'sm3771514', 'sm3064132', 'sm21552346', 'sm9002278', 'sm5525531',
            'sm22122720', 'sm14780909', 'sm16212632', 'sm17893633', 'nm7053908',
            'sm3601571', 'sm12658454', 'sm22937799', 'sm9129998', 'sm31808640',
            'sm5665639', 'sm5671863', 'sm14606732', 'sm1888221', 'sm2411052',
            'sm17234363', 'sm19595505']


def generate_track_id():
    # 10文字の英数字をランダムに生成
    first_part = ''.join(
        random.choices(string.ascii_letters + string.digits, k=10))

    # アンダースコアを1文字
    second_part = '_'

    # 13桁の数字をランダムに生成
    third_part = str(random.randint(10 ** 12, 10 ** 13 - 1))

    # 3つを連結して返す
    return first_part + second_part + third_part


# 空のリストを作成
result_list = []

# 開始インデックスから8回リクエストを行う
for idx in range(start_idx, start_idx + 8):
    if idx >= len(movieIds):
        print("Reached the end of movieIds list.")
        break

    movieId = movieIds[idx]
    actionTrackId = generate_track_id()
    try:
        url = "https://www.nicovideo.jp/api/watch/v3_guest/{}?actionTrackId={}&_frontendVersion=6".format(
            movieId, actionTrackId)

        res = requests.post(url, headers=headers).json()
        threadId = res["data"]["comment"]["layers"][0]["threadIds"][0]["id"]
        pair_dict = {"movieId": movieId, "threadId": threadId}
        result_list.append(pair_dict)
        print(pair_dict)
    except Exception as e:
        print(idx, e)
        break

# dictをJSONとして保存
with open(f'./JSONs/vocaloid/vocaloid_threadId_{start_idx}.json', 'w') as f:
    json.dump(result_list, f, indent=4)
